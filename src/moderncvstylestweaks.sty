%% moderncvstylestweaks.sty
%% Copyright 2013 Frank Milthaler
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License version 1.3c,
% available at http://www.latex-project.org/lppl/.
% 
% These tweaks make some changes to existing command and adds
% new commands to the moderncv package.
%
% The Current Maintainer of this file file is Frank Milthaler.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{moderncvstylestweaks}[2013/10/30 some tweaks and additions for v1.5.1 of the moderncv package]

%-------------------------------------------------------------------------------
%                New address/title command allowing for more lines
%-------------------------------------------------------------------------------
\NewDocumentCommand{\longaddress}{mG{}G{}G{}G{}}{\def\@addressstreet{#1}\def\@addresslinetwo{#2}\def\@addresscity{#3}\def\@addresscounty{#4}\def\@addresscountry{#5}}
\NewDocumentCommand{\longtitle}{mG{}G{}}{\def\@titleone{#1}\def\@titletwo{#2}\def\@titlethree{#3}}

%-------------------------------------------------------------------------------
%                symbols
%-------------------------------------------------------------------------------
\moderncvicons{marvosym}
% And adding the symbol for the address:
\renewcommand*{\addresssymbol}{\marvosymbol{98}~}
\newcommand*{\linksymbol}{\marvosymbol{90}~}
\newcommand*{\keyboardsymbol}{\marvosymbol{207}~}

%-------------------------------------------------------------------------------
%                colors
%-------------------------------------------------------------------------------
% Modifying colors (forcing certain colors for now):
\definecolor{namecolor}{rgb}{0.1294,0.3333,0.5608} % blue
\definecolor{quotecolor}{rgb}{0.65,0.65,0.65} % grey
\definecolor{myurlcolor}{rgb}{0.35,0.35,0.35} % grey
\newcommand*{\definenamecolor}[3]{%
  \ifthenelse{\equal{#1}{}}%
  {\definecolor{namecolor}{rgb}{0.1294}{0.3333}{0.5608}} % default always blue for now
  {\definecolor{namecolor}{rgb}{#1,#2,#3}}
}
\newcommand*{\definequotecolor}[3]{%
  \ifthenelse{\equal{#1}{}}%
  {\definecolor{quotecolor}{rgb}{0.65,0.65,0.65}} % default always light grey for now
  {\definecolor{quotecolor}{rgb}{#1,#2,#3}}
}
\newcommand*{\definemyurlcolor}[3]{%
  \ifthenelse{\equal{#1}{}}%
  {\definecolor{myurlcolor}{rgb}{0.35,0.35,0.35}} % default always grey for now
  {\definecolor{myurlcolor}{rgb}{#1,#2,#3}}
}
% also a command to overwrite color1 (title, section, subsection, hintcolumn):
\newcommand*{\definecolori}[3]{%
  \ifthenelse{\equal{#1}{}}%
  {\definecolor{color1}{rgb}{0.35,0.35,0.35}} % default always grey for now
  {\definecolor{color1}{rgb}{#1,#2,#3}}
}



%-------------------------------------------------------------------------------
%                resume style definition
%-------------------------------------------------------------------------------
% fonts
\newcommand*{\myurlfont}{\small\slshape} % \scshape \ttfamily
% styles:
\newcommand*{\myurlstyle}[1]{{\myurlfont\color{myurlcolor}{#1}}}


% Adding some commands:
% Adding a new httplink command:
\newcommand*{\myhttplink}[2][]{%
  \ifthenelse{\equal{#1}{}}%
    {\href{http://#2}{\myurlstyle{#2}}}%
    {\href{http://#2}{\myurlstyle{#1}}}}

% Adding a new command for software project entries, like cvitem but with http link:
% usage: \cvswitem[spacing]{name of project}{optional: url}{description}
\newcommand*{\cvswitem}[4][.25em]{%
  \cvitem[#1]{\myhttplink[\color{black}{\textnormal{\textbf{#2}}}]{#3}}{#4}
  }%
% And another command for software entries, but this time like cventry:
% usage: \cvswdetail[spacing]{name of project}{author/copyright}{programming language}{optional: url}{optional: comment/short program description}
\newcommand*{\cvswdetail}[6][.25em]{%
  \cvitem[#1]{%
    \ifthenelse{\equal{#5}{}}% no link given:
      {\myurlfont\textnormal{\textbf{#2}}} % without link
      {\myhttplink[\color{black}{\textnormal{\textbf{#2}}}]{#5}} % with link
    }{%
    {\bfseries\copyright~#3}%author
    {,~{\keyboardsymbol#4}}%programming language used
    \ifthenelse{\equal{#5}{}}{}{,~\myhttplink[\color{black}{\linksymbol#5}]{#5}}%printed link
    .\strut%
    \ifx&#6&%description
      \else{\newline{}\begin{minipage}[t]{\linewidth}\small#6\end{minipage}}\fi}}


\NewDocumentCommand{\refereeonecontact}{mG{}G{}G{}G{}mm}{%
%  \expandafter\def\csname refereeaddressstreet\endcsname{#1}%
  \def\@refereeoneaddressstreet{#1}\def\@refereeoneaddresslinetwo{#2}\def\@refereeoneaddresscity{#3}\def\@refereeoneaddresscounty{#4}\def\@refereeoneaddresscountry{#5}\def\@refereeonephonenumber{#6}\def\@refereeoneemail{#7}}

\NewDocumentCommand{\refereeonedetails}{G{}mG{}}{%
  \def\@refereeonerelation{#1}\def\@refereeonename{#2}\def\@refereeonetitle{#3}
}

\NewDocumentCommand{\refereeoneentry}{}{
  \cvcolumn{\@refereeonerelation}{%
    \begin{tabular}[b]{lp{1ex}l}
      \multicolumn{3}{l}{\textbf{\@refereeonename}}\\
      \multicolumn{3}{l}{\@refereeonetitle}\\
      \addresssymbol & & \@refereeoneaddressstreet\\
      & & \@refereeoneaddresslinetwo\\
      & & \@refereeoneaddresscity\\
      & & \@refereeoneaddresscounty\\
      & & \@refereeoneaddresscountry\\
      \phonesymbol & & \@refereeonephonenumber\\
      \emailsymbol & & \emaillink{\@refereeoneemail}
    \end{tabular}%
  }}%
  % entry has been written, flush details now:
  %\flushreferee
%}%


\NewDocumentCommand{\refereetwocontact}{mG{}G{}G{}G{}mm}{%
%  \expandafter\def\csname refereeaddressstreet\endcsname{#1}%
  \def\@refereetwoaddressstreet{#1}\def\@refereetwoaddresslinetwo{#2}\def\@refereetwoaddresscity{#3}\def\@refereetwoaddresscounty{#4}\def\@refereetwoaddresscountry{#5}\def\@refereetwophonenumber{#6}\def\@refereetwoemail{#7}}

\NewDocumentCommand{\refereetwodetails}{G{}mG{}}{%
  \def\@refereetworelation{#1}\def\@refereetwoname{#2}\def\@refereetwotitle{#3}
}

\NewDocumentCommand{\refereetwoentry}{}{
  \cvcolumn{\@refereetworelation}{%
    \begin{tabular}[b]{lp{1ex}l}
      \multicolumn{3}{l}{\textbf{\@refereetwoname}}\\
      \multicolumn{3}{l}{\@refereetwotitle}\\
      \addresssymbol & & \@refereetwoaddressstreet\\
      & & \@refereetwoaddresslinetwo\\
      & & \@refereetwoaddresscity\\
      & & \@refereetwoaddresscounty\\
      & & \@refereetwoaddresscountry\\
      \phonesymbol & & \@refereetwophonenumber\\
      \emailsymbol & & \emaillink{\@refereetwoemail}
    \end{tabular}%
  }
}

% end of file moderncvstylestweaks.sty
